<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on VULNIX</title>
        <link>https://theupbeat.github.io/posts/</link>
        <description>Recent content in Posts on VULNIX</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Thu, 23 Jul 2020 18:00:00 +0530</lastBuildDate>
        <atom:link href="https://theupbeat.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>Creating and Managing Virtual Machines using Libvirt</title>
            <link>https://theupbeat.github.io/posts/vm_2/</link>
            <pubDate>Thu, 23 Jul 2020 18:00:00 +0530</pubDate>
            
            <guid>https://theupbeat.github.io/posts/vm_2/</guid>
            <description>As we have seen a little into KVM/QEMU, Libvirt in the previous post, this post will demonstrate how to create, manage and remove virtual machines.
 Note
I use Void Linux as my base operating system (recently hoped from Manjaro), so the commands will be according to it. But most of the packages are some with similar or different names.
 Before installing packages for KVM/QEMU, we need to check for KVM support.</description>
            <content type="html"><![CDATA[<p>As we have seen a little into KVM/QEMU, Libvirt in the previous post, this post will demonstrate how to create, manage and remove virtual machines.</p>
<hr>
<p><strong>Note</strong></p>
<p>I use Void Linux as my base operating system (recently hoped from Manjaro), so the commands will be according to it. But most of the packages are some with similar or different names.</p>
<hr>
<p>Before installing packages for KVM/QEMU, we need to check for KVM support.</p>
<h2 id="prerequisites-for-kvm">Prerequisites for KVM:</h2>
<ul>
<li>
<p>To use KVM the host&rsquo;s processor should support virtualization. It is named different for different processor <code>VT-x</code> for <code>Intel</code> and <code>AMD-V</code> for <code>AMD</code> processors.</p>
</li>
<li>
<p>To check whether the system provides the support for virtualization for either CPUs, use the following command:</p>
</li>
</ul>
<pre><code>LC_ALL=C lscpu | grep Virtualization
</code></pre><p>Or</p>
<pre><code>grep -E 'vmx|svm|0xc0f' /proc/cpuinfo
</code></pre><p>If nothing is displayed after running either of the two commands, then the processor does not support hardware virtualization, and will unable to use KVM.</p>
<p>The virtualization support can be turned on in the BIOS (if available).</p>
<ul>
<li>To enable KVM, your user must be added to the <code>KVM</code> group:</li>
</ul>
<pre><code>usermod -aG kvm &lt;username&gt;
</code></pre><ul>
<li>To check whether the modules are loaded in the kernel, use the following command:</li>
</ul>
<pre><code>lsmod | grep kvm
</code></pre><p>If the output is either <code>kvm_intel</code> or <code>kvm_amd</code>, the modules are loaded.</p>
<p>If the modules are not loaded, use the following command to do so:</p>
<pre><code>modprobe kvm-amd # for AMD CPUs

modprobe kvm-intel # for Intel CPUs
</code></pre><ul>
<li>Kernel version should be greater than <code>2.6.60</code>.</li>
</ul>
<h2 id="packages-and-dependencies">Packages and Dependencies</h2>
<p>If everything is set right, we need to install the packages and dependencies that are required to create/manage a VM.</p>
<ul>
<li><code>qemu</code> - This package provides the <code>x86_64</code> architecture emulators for both full-system emulation (<code>qemu-system-x86_64</code>) and usermode (<code>qemu-x86_64</code>) variants.</li>
</ul>
<pre><code>xbps-install -S qemu
</code></pre><ul>
<li><code>bridge-utils</code> - Bridges the physical interfaces and the VM interfaces</li>
</ul>
<pre><code>xbps-install -S bridge-utils
</code></pre><ul>
<li><code>libvirt</code> - The libvirt package provides the daemon libvirtd which handles library calls, manages virtual machines and hypervisor controls.</li>
</ul>
<pre><code>xbps-install -S libvirt
</code></pre><p>Add the user to the libvirt group:</p>
<pre><code>usermod -aG libvirt &lt;user&gt;
</code></pre><p>To start the <code>libvirtd</code> daemon, run:</p>
<pre><code>ln -s /etc/sv/libvirtd /var/service
</code></pre><p>To check the status:</p>
<pre><code>sv status libvirtd
</code></pre><ul>
<li><code>virt-manager</code> - virt-manager is a graphical tool for managing virtual machines via libvirt. It includes virt-install, virt-clone, virt-xml.</li>
</ul>
<pre><code>xbps-install -S virt-manager
</code></pre><p>Start the <code>virtlogd</code> service:</p>
<pre><code>ln -s /etc/sv/virtlogd/ /var/service/
</code></pre><ul>
<li><code>libguestfs</code> - libguestfs is a set of tools for accessing and modifying virtual machine (VM) disk images. It can access alomost any disk image including Vmware’s VMDK &amp; Hyper-V disk format.</li>
</ul>
<pre><code>xbps-install -S libguestfs
</code></pre><p>This package includes virsh.</p>
<ul>
<li><code>virt-viewer</code> - Virt Viewer provides a graphical viewer for the guest OS display. At this time is supports guest OS using the VNC or SPICE protocols.</li>
</ul>
<pre><code>xbps-install -S virt-viewer
</code></pre><p><strong>To install all the packages</strong></p>
<pre><code>xbps-install -S qemu bridge-utils libvirt virt-manager libguestfs virt-viewer
</code></pre><h2 id="creating-a-vm">Creating a VM</h2>
<p>Now that we have installed all the required packages and its dependencies, we can now proceed to create a virtual machine with <code>virt-install</code>.</p>
<p>Now before getting into it, the following are the details of the VM to be created:</p>
<pre><code>VM Name   -   Manjaro
NETWORK   -   virbr0 (virbr0/br0)
RAM       -   4096
CPU       -   4
DISK      -   25GB
CD-ROM    -   /vol1/ISO/manjaro.iso
</code></pre><ul>
<li><code>virt-install</code> options that are required to create a VM:</li>
</ul>
<table>
<thead>
<tr>
<th>Options</th>
<th>Values</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>--connect</td>
<td>qemu:///system</td>
<td>Connect to the localhost KVM</td>
</tr>
<tr>
<td>--name</td>
<td>Manjaro</td>
<td>Name of the VM</td>
</tr>
<tr>
<td>--ram</td>
<td>4096</td>
<td>Size of RAM in MB</td>
</tr>
<tr>
<td>--vcpus</td>
<td>4</td>
<td>No. of vcpus</td>
</tr>
<tr>
<td>--os-type</td>
<td>linux</td>
<td>OS type</td>
</tr>
<tr>
<td>--os-variant</td>
<td>manjaro</td>
<td>OS variant (use osinfo-query os)</td>
</tr>
<tr>
<td>--network</td>
<td>network=virbr0</td>
<td>Bridge for network connectivity</td>
</tr>
<tr>
<td>--graphics</td>
<td>spice</td>
<td>Configure guest display settings</td>
</tr>
<tr>
<td>--virt-type</td>
<td>kvm</td>
<td>Virtualization type as KVM or Xen</td>
</tr>
<tr>
<td>--disk size</td>
<td>25</td>
<td>Disk Space of the VM</td>
</tr>
<tr>
<td>--cdrom</td>
<td>/path/of/iso</td>
<td>Path for the ISO file</td>
</tr>
</tbody>
</table>
<pre><code>virt-install --connect qemu:///system --name Manjaro --ram 4096 --vcpus 4 --os-type linux --os-variant manjaro --network bridge=virbr0 --graphics spice --virt-type kvm --disk size=25 --cdrom /vol1/ISO/manjaro-xfce-20.0.1-200511-linux56.iso
</code></pre><ul>
<li>To shutdown the machine</li>
</ul>
<pre><code>virsh shutdown &lt;domain-name&gt;
</code></pre><h2 id="managing-virtual-machines-with-virsh">Managing virtual machines with virsh</h2>
<ul>
<li>
<p>The user can create, manage, delete, start and stop virtual machines with the virsh command.</p>
</li>
<li>
<p>It can be used in scripts for automating some of the aspects of managing the virtual machine.</p>
</li>
<li>
<p>The terminology virsh uses is a little different. The term <code>domain</code> will be used instead of the term guest virtual machine.</p>
</li>
<li>
<p>The virtual machine that is created in one user cannot be retrieved by other user. To access all the virtual machines in a system, change the livbirt URL to access all the guests in a system.</p>
</li>
</ul>
<pre><code>virsh --connect qemu:///system list --all
</code></pre><p>The above command outputs the guest machines in a single system including all the ones from different users.</p>
<ul>
<li>
<p>The domain name of the machine create above is <code>Manjaro</code>.</p>
</li>
<li>
<p>To start a virtual machine</p>
</li>
</ul>
<pre><code>virsh --connect qemu:///system start Manjaro
</code></pre><ul>
<li>To reboot a virtual machine</li>
</ul>
<pre><code>virsh --connect qemu:///system reboot Manjaro
</code></pre><ul>
<li>To shutdown a virtual machine</li>
</ul>
<pre><code>virsh --connect qemu:///system shutdown Manjaro
</code></pre><ul>
<li>To suspend a virtual machine</li>
</ul>
<pre><code>virsh --connect qemu:///system suspend Manjaro
</code></pre><ul>
<li>To resume a virtual machine</li>
</ul>
<pre><code>virsh --connect qemu:///system resume Manjaro
</code></pre><h3 id="to-edit-the-storage-path-of-the-virtual-machine">To edit the storage path of the virtual machine</h3>
<p>In KVM, the virtual machines are store in <code>/var/lib/libvirt/images</code>. The default storage path can be changed to the users preference.</p>
<ul>
<li>
<p>First, login to the host machine. Shutdown all the VMs, if any loaded.</p>
</li>
<li>
<p>To list the storage pool</p>
</li>
</ul>
<pre><code>virsh --connect qemu:///system pool-list
</code></pre><ul>
<li>To get the info about the storage pool</li>
</ul>
<pre><code>virsh --connect qemu:///system pool-info default
</code></pre><ul>
<li>To get the path of the storage pool</li>
</ul>
<pre><code>virsh --connect qemu:///system pool-dumpxml default | grep -i path
</code></pre><ul>
<li>To check whether the existing VMs are located in the pool path</li>
</ul>
<pre><code>virsh --connect qemu:///system vol-list default | grep &quot;/var/lib/libvirt/images&quot;

virsh --connect qemu:///system vol-list default
</code></pre><ul>
<li>Before changing the path, stop the storage pool</li>
</ul>
<pre><code>virsh --connect qemu:///system pool-destroy default
</code></pre><ul>
<li>Edit the default pool configuration</li>
</ul>
<pre><code>virsh --connect qemu:///system pool-edit default
</code></pre><ul>
<li>Edit the default pool configuration</li>
</ul>
<pre><code>virsh --connect qemu:///system pool-edit default
</code></pre><ul>
<li>
<p>Change the path in the <code>&lt;path&gt;your_new_path&lt;/path&gt;</code></p>
</li>
<li>
<p>After editing the path, start the storage pool.</p>
</li>
</ul>
<pre><code>virsh --connect qemu:///system pool-start default
</code></pre><ul>
<li>To verify</li>
</ul>
<pre><code>virsh --connect qemu:///system pool-dumpxml default | grep -i path
</code></pre><ul>
<li>To move the exciting VMs to the new path</li>
</ul>
<pre><code>mv /var/lib/libvirt/images/&lt;name_of_vm&gt;.qcow2 /your/new/path/
</code></pre><ul>
<li>Edit the VM config&rsquo;s to the new path</li>
</ul>
<pre><code>virsh --connect qemu:///system edit Manjaro
</code></pre><p>Change the <code>source file='/var/lib/libvirt/images/&lt;name_of_vm&gt;.qcow2'</code> to <code>source file='\your\new\path\&lt;name_of_vm&gt;.qcow2'</code></p>
<ul>
<li>Everything is set. Start the KVM guest.</li>
</ul>
<pre><code>virsh --connect qemu:///system start Manjaro
</code></pre><h3 id="add-virtual-disk-to-an-active-virtual-machine">Add virtual disk to an active virtual machine</h3>
<p>To add extra disk space to an existing VM</p>
<ul>
<li><code>qemu-img</code> is used to create a virtual disk</li>
</ul>
<pre><code>qemu-img resize Manjaro.qcow2 +10G
</code></pre><p>This add (&lsquo;+&rsquo;) 10GB to the virtual machine.</p>
<h3 id="add-memory-to-the-virtual-machine">Add Memory to the virtual machine</h3>
<p>For example, lets try to increase the memory of the virtual machine from 4GB to 6GB.</p>
<ul>
<li>
<p>Shutdown the virtual machine</p>
</li>
<li>
<p>Using <code>virsh edit</code> edit the VM</p>
</li>
</ul>
<pre><code>virsh --connect qemu:///system edit Manjaro
</code></pre><ul>
<li>
<p>Change the value of the memory size (in KiB) in <code>&lt;memory unit='KiB'&gt;4194304&lt;/memory&gt;</code> to <code>&lt;memory unit='KiB'&gt;6291456&lt;/memory&gt;</code></p>
</li>
<li>
<p>Save the file and exit. Restarting the VM will show the updated configuration.</p>
</li>
</ul>
<h3 id="add-vcpus-to-a-virtual-machine">Add VCPUs to a virtual machine</h3>
<p>To increase the number of VCPUs allocated to a virtual machine edit the xml file.</p>
<ul>
<li>
<p>Shutdown the virtual machine.</p>
</li>
<li>
<p>Using <code>virsh edit</code> edit the configuration of the virtual machine.</p>
</li>
<li>
<p>Change the value from <code>&lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;</code> to <code>&lt;vcpu placement='static'&gt;4&lt;/vcpu&gt;</code></p>
</li>
<li>
<p>Save and exit. Restarting the virtual machine should change the configuration.</p>
</li>
</ul>
<h3 id="saving-the-configuration-and-recreating">Saving the configuration and recreating</h3>
<p>The configuration of virtual machine can be saved and can be used to recreate the virtual machine.</p>
<ul>
<li>To Save</li>
</ul>
<pre><code>virsh --connect qemu:///connect dumpxml Manjaro &gt; Manjaro.xml
</code></pre><ul>
<li>To recreate the machine from the <code>xml</code> configuration</li>
</ul>
<pre><code>virsh --connect qemu:///system create Manjaro.xml
</code></pre><h3 id="delete-the-virtual-machine">Delete the virtual machine</h3>
<ul>
<li>
<p>Shutdown the virtual machine</p>
</li>
<li>
<p>Destroy the virtual machine</p>
</li>
</ul>
<pre><code>virsh --connect qemu:///system destroy Manjaro
</code></pre><ul>
<li>Undefine the virtual machine</li>
</ul>
<pre><code>virsh --connect qemu:///system undefine Manjaro
</code></pre><ul>
<li>Now, remove the disk image file from the system</li>
</ul>
<pre><code>rm /var/lib/libvirt/images/Manjaro.qcow2
</code></pre>]]></content>
        </item>
        
        <item>
            <title>KVM, QEMU, Libvirt</title>
            <link>https://theupbeat.github.io/posts/vm_1/</link>
            <pubDate>Thu, 23 Jul 2020 15:00:00 +0530</pubDate>
            
            <guid>https://theupbeat.github.io/posts/vm_1/</guid>
            <description>Introduction I was looking into virtualization in Linux systems. As we know Linux has arsenal of tools in its back-pocket. It did have something up its sleeve KVM, QEMU, Libvirt. And there a lot of other 3rd party options like VMWare, VirtulBox to name some.
Its interesting that KVM is a kernel module in the Linux system, which helps in getting native-like performance in the virtual machine. So we will be looking into tweaking KVM, QEMU, Libvirt to our convenience and usage.</description>
            <content type="html"><![CDATA[<h2 id="introduction">Introduction</h2>
<p>I was looking into virtualization in Linux systems. As we know Linux has arsenal of tools in its back-pocket. It did have something up its sleeve KVM, QEMU, Libvirt. And there a lot of other 3rd party options like VMWare, VirtulBox to name some.</p>
<p>Its interesting that KVM is a kernel module in the Linux system, which helps in getting native-like performance in the virtual machine. So we will be looking into tweaking KVM, QEMU, Libvirt to our convenience and usage.</p>
<h2 id="a-tldr-of-virtualization">A tl;dr of Virtualization</h2>
<ul>
<li>
<p>Well, Virtualization is a technology which lets a user create multiple virtual instances of the same host OS or different one in a single, physical hardware.</p>
</li>
<li>
<p>This means we can create, manage and use multiple operating systems in a single machine.</p>
</li>
<li>
<p>There are many uses of a virtual machine. For Example</p>
<ul>
<li>To test an application in a particular environment.</li>
<li>To experience an operating system before moving to it.</li>
<li>To improve ones privacy by creating a true Internet sandboxes.</li>
<li>For Data centers and Service providers:
<ul>
<li>Resource efficiency</li>
<li>Easier management</li>
<li>Faster provisioning</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Virtualization is done with the help of <strong>Hypervisor</strong>. A Hypervisor is a software that creates and runs virtual machine. It connects directly to the hardware and allows a user to split a single system into separate, different environments. It also distributes the resources to the VM and the host appropriately. It can also be called as virtual machine monitor (VMM).</p>
</li>
</ul>
<p><img src="/img/4_1.png" alt="Virtual machine"></p>
<h3 id="hypervisor">Hypervisor</h3>
<ul>
<li>There are 2 types of Hypervisors
<ul>
<li>Type 1 - Bare Metal hypervisors</li>
<li>Type 2 - Hosted hypervisors</li>
</ul>
</li>
</ul>
<h4 id="type-1-hypervisor">Type 1 Hypervisor</h4>
<ul>
<li>
<p>A Type 1 hypervisor directly interacts with the physical hardware&rsquo;s CPU, memory, and storage.</p>
</li>
<li>
<p>They are mostly used in server-based environments.</p>
</li>
<li>
<p>These type of hypervisors are highly efficient. They provide bare-metal performances.</p>
</li>
<li>
<p>They require a separate management machine to control/administer different VMs and control the host machine.</p>
</li>
<li>
<p>Examples:</p>
<ul>
<li>KVM (Kernel-based Virtual Machine)</li>
<li>Xen</li>
<li>VMWare ESXi</li>
</ul>
</li>
</ul>
<h4 id="type-2-hypervisor">Type 2 Hypervisor</h4>
<ul>
<li>
<p>A Type 2 hypervisor runs in an application which runs in an OS.</p>
</li>
<li>
<p>They are mostly used by the individuals running multiple systems in their personal computer.</p>
</li>
<li>
<p>These type of hypervisors enables the use of multiple guest operating systems alongside the host for the end user.</p>
</li>
<li>
<p>They access the resources via host operating system introducing latency, which decreases the performance.</p>
</li>
<li>
<p>The security of these guest machines can be compromised.</p>
</li>
<li>
<p>Examples:</p>
<ul>
<li>QEMU</li>
<li>VirtualBox</li>
<li>VMWare Player</li>
<li>VMWare Workstation</li>
</ul>
</li>
</ul>
<h3 id="types-of-virtualization">Types of Virtualization</h3>
<ul>
<li>
<p>Desktop virtualization</p>
</li>
<li>
<p>Network virtualization</p>
</li>
<li>
<p>Storage virtualization</p>
</li>
<li>
<p>Data virtualization</p>
</li>
<li>
<p>Application virtualization</p>
</li>
<li>
<p>Data center virtualization</p>
</li>
<li>
<p>CPU virtualization</p>
</li>
<li>
<p>GPU virtualization</p>
</li>
<li>
<p>Linux virtualization</p>
</li>
<li>
<p>Cloud virtualization</p>
</li>
</ul>
<p>We will looking into Linux Virtualization with KVM, QEMU, Libvirt.</p>
<h2 id="kvm">KVM</h2>
<ul>
<li>
<p>KVM stands for Kernel-based Virtual Machine.</p>
</li>
<li>
<p>It is built into the Linux kernel from 2.6.20.</p>
</li>
<li>
<p>KVM make the Linux into a hypervisor, which allows a user to to run multiple virtual machines in the host machine.</p>
</li>
<li>
<p>KVM converts Linux into type-1 hypervisor. Every guest machine hosted on the host machine in Linux with KVM is treated as a regular process.</p>
</li>
<li>
<p>The guest machines uses the standard Linux scheduler built into the kernel with the help of KVM.</p>
</li>
<li>
<p>Rest of the components like network card, graphics adapter, CPUs, memory and storage are virtualized.</p>
</li>
<li>
<p><strong>Features</strong></p>
<ul>
<li>As KVM is built in kernel it acquires the scalability and performance.</li>
<li>As the VM is a Linux process, it can be controlled through the kernel features like cgroups, completely fair scheduler, name spaces, etc.</li>
<li>It inherits memory management from the kernel, like kernel same-paging, non-uniform memory access.</li>
<li>It can support different types and hardware.</li>
<li>KVM uses SELinux (Security Enhanced Linux) and secure virtualization (sVirt) to improve VM&rsquo;s security.</li>
<li>Lower latency issues.</li>
</ul>
</li>
</ul>
<h2 id="qemu">QEMU</h2>
<ul>
<li>
<p>QEMU stands for Quick Emulator.</p>
</li>
<li>
<p>It is an open source machine emulator and virtualizer.</p>
</li>
<li>
<p>With the help of dynamic binary translation it can emulate a different machine&rsquo;s processor.</p>
</li>
<li>
<p>For example, using QEMU an user can emulate an ARM board in their PC.</p>
</li>
<li>
<p>By using binary translation it achieves good performance.</p>
</li>
<li>
<p>It can use other hypervisors like Xen, KVM to use Hardware-assisted virtualization.</p>
</li>
<li>
<p><strong>Features</strong></p>
<ul>
<li>QEMU can save and restore a virtual machine wit all the application running.</li>
<li>Operating systems need not to be patched for running them in QEMU.</li>
<li>Can emulate a lot different types of architectures.</li>
<li>Uses special format for storing the virtual machine qcow or qcow2. This formats only take up as much disk space as the guest OS does.</li>
<li>Allows the host and guest machine to communicate with integrating services like SMB server.</li>
<li>Can also support different image formats like <code>.vdi</code>, <code>.vmdk</code>, etc.</li>
</ul>
</li>
</ul>
<h2 id="libvirt">Libvirt</h2>
<ul>
<li>
<p>Libvirt is an Open source API, daemon that provides a way to manage virtual machines.</p>
</li>
<li>
<p>It can be used to manage KVM/QEMU, Xen, LXC, etc.</p>
</li>
<li>
<p><strong>Features</strong></p>
<ul>
<li>VM Management</li>
<li>Remote machine support</li>
<li>Storage management</li>
<li>Network interface management</li>
<li>Virtual NAT and Route based networking</li>
</ul>
</li>
<li>
<p>There are different user interfaces that use libvirt Virtual Machine Manager, GNOME Boxes, virsh, oVirt, etc.</p>
</li>
</ul>
<h2 id="differences-between-qemu-kvm-and-libvirt">Differences between QEMU, KVM and Libvirt</h2>
<ul>
<li>
<p>QEMU and KVM both act as a hypervisor.</p>
</li>
<li>
<p>QEMU runs slower when the system doesn&rsquo;t have hardware virtualization. To resolve this we use KVM. KVM helps QEMU access the virtualization features on different architectures. KVM also adds acceleration feature to the QEMU process.</p>
</li>
<li>
<p>Libvirt is a simple virtualization library. It is used to manage KVM and QEMU. It is effective and can handle a lot of hypervisors together. It consists of three utilities: API library, a daemon (libvirtd) and a command line tool (virsh).</p>
</li>
<li>
<p>So in-short:</p>
<ul>
<li>QEMU - Hypervisor</li>
<li>KVM - Accelerating agent</li>
<li>Libvirt - A Management library</li>
</ul>
</li>
</ul>
<h2 id="continued">Continued</h2>
<p>In the next post, we will be looking into virt-install to create VM and virsh to manage them.</p>
]]></content>
        </item>
        
        <item>
            <title>My Browser Configuration</title>
            <link>https://theupbeat.github.io/posts/browser_conf/</link>
            <pubDate>Sat, 11 Jul 2020 16:00:00 +0530</pubDate>
            
            <guid>https://theupbeat.github.io/posts/browser_conf/</guid>
            <description>A Browser is what we use to access the Internet i.e. the World. The technology has advanced to a level that we can mostly access/use everything from our palms. Out of all the software/applications the mostly helpful and useful one is a Browser.
In this post I would like to share my browser configuration and the extensions that I use to make my life a little secure, private and easier.</description>
            <content type="html"><![CDATA[<p>A Browser is what we use to access the Internet i.e. the World. The technology has advanced to a level that we can mostly access/use everything from our palms. Out of all the software/applications the mostly helpful and useful one is a Browser.</p>
<p>In this post I would like to share my browser configuration and the extensions that I use to make my life a little secure, private and easier.</p>
<p>The two devices that I mostly use are:</p>
<ol>
<li><strong>Laptop</strong></li>
</ol>
<ul>
<li><a href="#laptop">Details</a></li>
<li><a href="#browser-settings">Browser Settings</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#flags">Flags</a></li>
</ul>
<ol start="2">
<li><strong>Android Device</strong></li>
</ol>
<ul>
<li><a href="#android">Details</a></li>
<li><a href="#and-ads">AdBlocking and AdFiltering</a></li>
<li><a href="#and-flags">Flags</a></li>
</ul>
<h2 id="laptop">My Laptop Browser Configuration:</h2>
<p>Details:</p>
<ul>
<li>
<p>Operating System - Manjaro (Arch-Based)</p>
<ul>
<li><a href="https://manjaro.org/">Website</a></li>
<li><a href="https://manjaro.org/download/">Download</a></li>
</ul>
</li>
<li>
<p>Browser - Brave Browser (Chromium Based)</p>
<ul>
<li><a href="https://brave.com/">Website</a></li>
<li><a href="https://brave.com/download/">Download</a></li>
</ul>
</li>
</ul>
<hr>
<p><strong>Note</strong></p>
<p>As I use Brave as my default browser most of the configuration will be according to it.</p>
<hr>
<h3 id="browser-settings">Browser Settings</h3>
<p>Brave out-of-the-box is configured very neatly, for someone with basic needs may not need to tinker anything expect for the startup settings. Brave has an inbuilt adblocker that blocks almost all the third-party ads and trackers in the website. But Brave can be configured a lot to improve both the security and privacy.</p>
<ul>
<li>
<p>To access the settings panel use can either type <code>brave://settings</code> in the address bar or use the hamburger section present in the right top to access it.</p>
<p><img src="/img/3_1.png" alt="hamburger menu"></p>
</li>
<li>
<p>All the settings are mostly intuitive. Go through all the settings and enable/disable it as per your choice. The Following are the ones that I have enabled/disabled:</p>
<ul>
<li>
<p>Enabled <code>Show autocomplete in address bar</code> (uses some cookies to do so)</p>
<p><img src="/img/3_2.png" alt="autocomplete"></p>
</li>
<li>
<p>Disabled <code>Show top sites in autocomplete suggestions</code> and <code>Show Brave suggested sites in autocomplete suggestions</code> (prevents the issue of brave referrals)</p>
<p><img src="/img/3_3.png" alt="suggested"></p>
</li>
<li>
<p>Shields section</p>
<ul>
<li>
<p>The Shields is activated by default. The default is set to <code>Simple view</code>, select the <code>Advanced view</code> to get more information shown in the bar.</p>
<p><img src="/img/3_4.png" alt="shields"></p>
</li>
<li>
<p>Block cross-site trackers - Blocks advertisements and trackers that are in the sites.</p>
</li>
<li>
<p>Upgrade connections to HTTPS - It uses <a href="https://www.eff.org/https-everywhere">HTTPS Everywhere&rsquo;s</a> rule set to achieve this.</p>
</li>
<li>
<p>Block Scripts - Javascript in a website will be blocked (some websites may not work as intended). The default is set to be disabled as most of the websites use Javascript and so do the trackers/ads (I intend to block it).</p>
</li>
<li>
<p>Cookies - It is set to accept only the 1st party ones (the website the user is in), blocking all the other 3rd party cookies. It can be set to Block all to improve privacy, but sometimes comfortability takes the choice.</p>
</li>
<li>
<p>Fingerprinting - Set to Block all Fingerprinting. Enabling this will improve our privacy a lot. More on <a href="https://github.com/brave/brave-browser/wiki/Fingerprinting-Protections">Fingerprinting Protection</a>.</p>
</li>
</ul>
<blockquote>
<p>Even without the use of cookies, some websites can identify the way your browser and device differ from others in order to recognize you based on your unique combination of these traits. This approach is called “Fingerprinting” (sometimes referred to as “Device Recognition”).</p>
</blockquote>
<ul>
<li>For Further reading, read the article by <a href="https://support.brave.com/hc/en-us/articles/360022806212-How-do-I-use-Shields-while-browsing-">Brave</a>.</li>
</ul>
</li>
<li>
<p>Social media blocking</p>
<ul>
<li>
<p>As the section header says it blocks/removes all the tracking and embedded links in a sites that are related to the specified websites.</p>
<p><img src="/img/3_5.png" alt="Social Media Blocking"></p>
</li>
</ul>
</li>
<li>
<p>Search Engine</p>
<ul>
<li>
<p>This section lets you select the default search engine. If not initially changed at the startup of the browser.</p>
</li>
<li>
<p>To add a url of choice add <code>/search?q=%s</code> at the end of the url.</p>
</li>
<li>
<p>For Example, I use <a href="https://github.com/benbusby/whoogle-search">Whoole Search</a> a self-hosted search engine runs at <code>localhost:8888</code>.</p>
</li>
<li>
<p>To make it as my default search engine, Click the <code>Add</code> option in the <code>Manage search engines</code> section and add <code>localhost:8888/search?q=%s</code>.</p>
</li>
</ul>
</li>
<li>
<p>Extensions Section</p>
<ul>
<li>
<p>Not the extensions but the extensions section in the settings.</p>
<p><img src="/img/3_6.png" alt="extensions"></p>
</li>
<li>
<p><code>Web3 provider for using Dapps</code> and <code>Load Crypto Wallets on startup</code> are for Crypto and struff.</p>
</li>
<li>
<p>Brave supports an amazing feature <code>TOR</code>. It can be used from the hamburger section in the toolbar.</p>
</li>
<li>
<p><code>WebTorrent</code> lets you torrent directly in the browser.</p>
</li>
<li>
<p>Enabled <code>Widevine</code> for streaming services.</p>
</li>
</ul>
</li>
<li>
<p>Brave has an option that checks for data breaches, bad extensions and more called <code>Safety Check</code>.</p>
</li>
<li>
<p>Enabled <code>Do Not Track</code>, which sends a &ldquo;Do Not Track&rdquo; request with your browsing traffic.</p>
</li>
<li>
<p>Enabled <code>Use hardware acceleration when available</code> for good performances.</p>
</li>
</ul>
</li>
</ul>
<h3 id="extensions">Extensions</h3>
<ul>
<li><a href="#ublock-origin">uBlock Origin</a></li>
<li><a href="#umatrix">uMatrix</a></li>
<li><a href="#uboextra">uBlock Origin Extra</a></li>
<li><a href="#cleanurls">CleanURLs</a></li>
<li><a href="#bypasspaywalls">Bypass Paywalls</a></li>
<li><a href="#random">Random User-Agent</a></li>
<li><a href="#tampermonkey">Tampermonkey</a></li>
<li><a href="#pb">Privacy Badger</a></li>
<li><a href="#font">Font Fingerprint Defender</a></li>
<li><a href="#audio">AudioContext Fingerprint Defender</a></li>
<li><a href="#webgl">WebGL Fingerprint Defender</a></li>
<li><a href="#geo">Change Geolocation(Location Guard)</a></li>
<li><a href="#ub">Universal Bypass</a></li>
<li><a href="#behave">Behave!</a></li>
<li><a href="#css">CSS Exfil Protection</a></li>
<li><a href="#h264ify">h264ify</a></li>
<li><a href="#suspender">The Great Suspender</a></li>
<li><a href="#sponsorblock">SponsorBlock for YouTube</a></li>
<li><a href="#redirect">Redirector</a></li>
</ul>
<h4 id="extension-links-and-configuration"><em>Extension links and configuration</em></h4>
<h4 id="ublock-origin">uBlock Origin</h4>
<blockquote>
<p>An efficient blocker add-on for various browsers. Fast, potent, and lean.</p>
</blockquote>
<ul>
<li>
<p><em>Links</em>:</p>
<ul>
<li>
<p><a href="https://github.com/gorhill/uBlock">Source Code</a></p>
</li>
<li>
<p><a href="https://github.com/gorhill/uBlock#chromium">Chrome</a></p>
</li>
<li>
<p><a href="https://github.com/gorhill/uBlock#firefox--firefox-for-android">Firefox</a></p>
</li>
</ul>
</li>
<li>
<p><em>My configuration</em></p>
<ul>
<li>
<p>I have blocked all the 3rd party stuff, which includes <code>3rd-party</code>, <code>3rd-party scripts</code> and <code>3rd-party frames</code> (to get the ability to do this turn on the <code>I am a advanced user</code> option in the uBlock settings).</p>
<p><img src="/img/3_7.png" alt="uBlock"></p>
</li>
<li>
<p><em>Extension Settings</em></p>
<ul>
<li>
<p><em>Under Privacy section (Enabled):</em></p>
<ul>
<li>
<p>Disable pre-fetching (to prevent any connection for blocked network requests)</p>
<blockquote>
<p>Checking this will disable prefetching in your browser. When prefetching is enabled, the browser can still establish connections to remote servers even if the resource from these remote servers are meant to be blocked by uBlock.</p>
</blockquote>
<p>For further reading - <a href="https://github.com/gorhill/uBlock/wiki/Dashboard:-Settings#disable-pre-fetching">Disable pre-fetching</a></p>
</li>
<li>
<p>Disable hyperlink auditing</p>
<blockquote>
<p>Checking this will prevent hyperlink auditing. Hyperlink auditing is best summarized as &ldquo;phone home&rdquo; feature (or more accurately &ldquo;phone anywhere&rdquo;) meant to inform one or more servers of which links you click on (and when).</p>
</blockquote>
<p>For further reading - <a href="https://github.com/gorhill/uBlock/wiki/Dashboard:-Settings#disable-hyperlink-auditing">Disable hyperlink auditing</a></p>
</li>
<li>
<p>Prevent WebRTC from leaking local IP addresses</p>
<blockquote>
<p>Keep in mind that this feature is to prevent leakage of your non-internet-facing IP adresses. The purpose of this feature is not to hide your current internet-facing IP address &ndash; so be cautious to not misinterpret the results of the tests above. For example, if you use a VPN, your internet-facing IP address is that of the VPN, so your ISP-provided IP address should not be visible to outside world with this setting checked. However, if you are not behind any VPN or proxy, your ISP-provided IP address will be visible regardless of this setting.</p>
</blockquote>
<p>For further reading - <a href="https://github.com/gorhill/uBlock/wiki/Dashboard:-Settings#prevent-webrtc-from-leaking-local-ip-address">Prevent WebRTC from leaking local IP address</a></p>
</li>
<li>
<p>Block CSP reports</p>
<blockquote>
<p>You can block network requests made as a result of your browser reporting Content Security Policy violations (&ldquo;CSP reports&rdquo;) to a remote server (which can be 3rd-party to the site where the violation occurred).</p>
</blockquote>
<p>For further reading - <a href="https://github.com/gorhill/uBlock/wiki/Dashboard:-Settings#block-csp-reports">Block CSP reports</a></p>
</li>
</ul>
</li>
<li>
<p><em>Filter Lists</em></p>
<blockquote>
<p>The Filter lists pane is where you subscribe to filter lists. The filter lists to which you subscribe will feed uBlock Origin&rsquo;s static filtering engine.&rdquo;</p>
</blockquote>
<ul>
<li>
<p>I have mostly enabled all the default lists in the settings.</p>
<p><img src="/img/3_8.png" alt="filters"></p>
</li>
<li>
<p>Here are some more filters I use:</p>
<ul>
<li>
<p><a href="https://gitlab.com/CHEF-KOCH/cks-filterlist/-/raw/master/CK%27s-FilterList.txt">https://gitlab.com/CHEF-KOCH/cks-filterlist/-/raw/master/CK%27s-FilterList.txt</a></p>
</li>
<li>
<p><a href="https://www.i-dont-care-about-cookies.eu/abp/">https://www.i-dont-care-about-cookies.eu/abp/</a></p>
</li>
<li>
<p><a href="https://raw.githubusercontent.com/blocklistproject/Lists/master/facebook.txt">https://raw.githubusercontent.com/blocklistproject/Lists/master/facebook.txt</a></p>
</li>
<li>
<p><a href="https://raw.githubusercontent.com/badmojr/1Hosts/master/complete/hosts.txt">https://raw.githubusercontent.com/badmojr/1Hosts/master/complete/hosts.txt</a></p>
</li>
<li>
<p><a href="https://raw.githubusercontent.com/StevenBlack/hosts/master/alternates/fakenews/hosts">https://raw.githubusercontent.com/StevenBlack/hosts/master/alternates/fakenews/hosts</a></p>
</li>
<li>
<p><a href="https://raw.githubusercontent.com/TheUpBeat/Block-Ad-Web-Internet/master/Facebook_Blocked.txt">https://raw.githubusercontent.com/TheUpBeat/Block-Ad-Web-Internet/master/Facebook_Blocked.txt</a></p>
</li>
<li>
<p><a href="https://block.energized.pro/blu/formats/hosts">https://block.energized.pro/blu/formats/hosts</a></p>
</li>
<li>
<p><a href="https://raw.githubusercontent.com/brave/adblock-lists/master/coin-miners.txt">https://raw.githubusercontent.com/brave/adblock-lists/master/coin-miners.txt</a></p>
<p>For more check out - <a href="https://filterlists.com/">FilterLists</a></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="umatrix">uMatrix</h4>
<blockquote>
<p>Point and click matrix to filter net requests according to source, destination and type</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://github.com/gorhill/uMatrix">Source Code</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/%C2%B5matrix/ogfcmafjalglgifnmanfmnieipoejdcf">Chrome</a></p>
</li>
<li>
<p><a href="https://addons.mozilla.org/firefox/addon/umatrix/">Firefox</a></p>
</li>
</ul>
</li>
<li>
<p><em>My Configuration</em></p>
<ul>
<li>
<p>Same as uBlock, uMatrix also blocks ads and trackers in the website but with more functionality and controllability. I have disabled all the 3rd-party and 1st-party in uMatrix.</p>
<p><img src="/img/3_9.png" alt="uMatrix"></p>
</li>
<li>
<p>And most of other settings are set to default.</p>
</li>
<li>
<p>For more usage refer its <a href="https://github.com/gorhill/uMatrix/wiki">Wiki</a>. There are lot of features to tinker with.</p>
</li>
</ul>
</li>
</ul>
<h4 id="uboextra">uBlock Origin Extra</h4>
<blockquote>
<p>A companion extension to uBlock Origin: to gain ability to foil early anti-user mechanisms working around content blockers or even a browser privacy settings.</p>
<p>The extension is useful only for Chromium-based browsers. There is no need for such an extension so far on Firefox, and thus there is no version for Firefox.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://github.com/gorhill/uBO-Extra">Source Code</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/ublock-origin-extra/pgdnlhfefecpicbbihgmbmffkjpaplco">Chrome</a></p>
</li>
</ul>
</li>
<li>
<p><a href="https://github.com/gorhill/uBO-Extra/wiki/Sites-on-which-uBO-Extra-is-useful">Sites on which uBO Extra is useful</a></p>
</li>
<li>
<p><!-- raw HTML omitted --> <strong>CleanURLs</strong> <!-- raw HTML omitted --></p>
<blockquote>
<p>ClearURLs is an add-on based on the new WebExtensions technology and is optimized for Firefox and Chrome based browsers.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://gitlab.com/KevinRoebert/ClearUrls">Source Code</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/clearurls/lckanjgmijmafbedllaakclkaicjfmnk">Chrome</a></p>
</li>
<li>
<p><a href="https://addons.mozilla.org/firefox/addon/clearurls/">Firefox</a></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="bypasspaywalls">Bypass Paywalls</h4>
<blockquote>
<p>Bypass Paywalls is a web browser extension to help bypass paywalls for selected sites.</p>
</blockquote>
<ul>
<li>
<p><em>Lists:</em></p>
<ul>
<li>
<p><a href="https://github.com/iamadamdev/bypass-paywalls-chrome">Source Code</a></p>
</li>
<li>
<p>Chrome:</p>
<ul>
<li>
<p>Download this repo as a <a href="https://github.com/iamadamdev/bypass-paywalls-chrome/archive/master.zip">ZIP file from GitHub</a>.</p>
</li>
<li>
<p>Unzip the file and you should have a folder named <code>bypass-paywalls-chrome-master</code>.</p>
</li>
<li>
<p>In Chrome go to the extensions page.</p>
</li>
<li>
<p>Enable Developer Mode.</p>
</li>
<li>
<p>Drag the <code>bypass-paywalls-chrome-master</code> folder anywhere on the page to import it (do not delete the folder afterwards).</p>
</li>
</ul>
</li>
<li>
<p>Firefox:</p>
<ul>
<li>Download it from <a href="https://github.com/iamadamdev/bypass-paywalls-chrome/releases/latest/download/bypass-paywalls-firefox.xpi">Github</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Lists of sites that can be bypassed - <a href="https://github.com/iamadamdev/bypass-paywalls-chrome#bypass-the-following-sites-paywalls-with-this-extension">Websites</a></p>
</li>
</ul>
<h4 id="random">Random User-Agent</h4>
<blockquote>
<p>Automatically replaces the User-Agent after a specified time interval</p>
</blockquote>
<blockquote>
<p><strong>Warning</strong></p>
<p>Depending on your threat model, faking your user agent might make you more fingerprintable, not less. There are ways other than User-Agent sniffing to determine what browser you&rsquo;re using, so malicious sites could learn what browser you&rsquo;re really using through other means and then combine that with your randomly changing User-Agent to pretty effectively track you.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://github.com/tarampampam/random-user-agent">Source Code</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/random-hide-user-agent/einpaelgookohagofgnnkcfjbkkgepnp">Chrome</a></p>
</li>
<li>
<p><a href="https://addons.mozilla.org/firefox/addon/random_user_agent/">Firefox</a></p>
</li>
</ul>
</li>
</ul>
<h4 id="tampermonkey">Tampermonkey</h4>
<blockquote>
<p>Tampermonkey is the most popular userscript manager for Google Chrome.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://github.com/Tampermonkey/tampermonkey">Source Code</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/dhdgffkkebhmkfjojejmpbldmpobfkfo">Chrome</a></p>
</li>
</ul>
</li>
<li>
<p>Scripts I use:</p>
<ul>
<li>
<p><a href="https://greasyfork.org/scripts/735-anti-adblock-killer-reek">Anti-Adblock Killer</a></p>
</li>
<li>
<p><a href="https://greasyfork.org/en/scripts/6325-pinterest-without-registration">Pinterest without registration</a></p>
</li>
<li>
<p><a href="https://greasyfork.org/en/scripts/377129-reddit-add-removeddit-links">Reddit - Add Removeddit links</a></p>
</li>
<li>
<p><a href="https://greasyfork.org/en/scripts/370246-sci-hub-button">Sci-hub button</a></p>
</li>
<li>
<p><a href="https://greasyfork.org/en/scripts/4881-adsbypasser">AdsBypasser</a></p>
</li>
<li>
<p><a href="https://greasyfork.org/en/scripts/4294-antiadware">AntiAdware</a></p>
</li>
</ul>
</li>
</ul>
<h4 id="pb">Privacy Badger</h4>
<blockquote>
<p>Privacy Badger is a browser extension that automatically learns to block invisible trackers. Instead of keeping lists of what to block, Privacy Badger learns by watching which domains appear to be tracking you as you browse the Web.</p>
<p>Privacy Badger sends the Do Not Track signal with your browsing. If trackers ignore your wishes, your Badger will learn to block them. Privacy Badger starts blocking once it sees the same tracker on three different websites.</p>
<p>Besides automatic tracker blocking, Privacy Badger removes outgoing link click tracking on Facebook and Google, with more privacy protections on the way.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://github.com/EFForg/privacybadger">Source Code</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/privacy-badger/pkehgijcmpdhfbdbbnkijodmdjhbjlgp">Chrome</a></p>
</li>
</ul>
</li>
</ul>
<h4 id="font">Font Fingerprint Defender</h4>
<blockquote>
<p>Font Fingerprint Defender is a multi-browser addon that let you easily hide your real font fingerprint by reporting a random fake value. According to many tech blogs, completely blocking the fingerprint is not a good idea, therefore reporting a fake value could be the best solution to better protect your privacy. This addon simply adds a small noise to the actual fingerprint and renews it every time you visit a website or reload a page.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://mybrowseraddon.com/font-defender.html">Website</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/audiocontext-fingerprint/fhkphphbadjkepgfljndicmgdlndmoke">Chrome</a></p>
</li>
<li>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/font-fingerprint-defender/">Firefox</a></p>
</li>
</ul>
</li>
<li>
<p><!-- raw HTML omitted --> <strong>AudioContext Fingerprint Defender</strong> <!-- raw HTML omitted --></p>
<blockquote>
<p>AudioContext Fingerprint Defender is a multi-browser addon that let you easily hide your real audiocontext fingerprint by reporting a random fake value. This addon does not block audiocontext or any other web audio API methods. It simply adds a small noise to the actual fingerprint and renews it every time you visit a website or reload a page.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://mybrowseraddon.com/audiocontext-defender.html">Website</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/audiocontext-fingerprint/pcbjiidheaempljdefbdplebgdgpjcbe">Chrome</a></p>
</li>
<li>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/audioctx-fingerprint-defender/">Firefox</a></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="webgl">WebGL Fingerprint Defender</h4>
<blockquote>
<p>WebGL Fingerprint Defender is a multi-browser add-on that let you easily hide your real WebGL fingerprint by reporting a random fake value. According to many tech blogs, completely blocking WebGL API is not a good idea, therefore reporting a fake fingerprint could be the best solution to better protect your privacy. This addon simply adds a small noise to the actual fingerprint and renews it every time you visit a website or reload a page.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://mybrowseraddon.com/webgl-defender.html">Website</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/olnbjpaejebpnokblkepbphhembdicik">Chrome</a></p>
</li>
<li>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/webgl-fingerprint-defender/">Firefox</a></p>
</li>
</ul>
</li>
</ul>
<h4 id="geo">Change Geolocation(Location Guard)</h4>
<blockquote>
<p>Change Geolocation (Location Guard) is a multi-browser addon that let you easily change your geographic location to a desired value. Simply open addon options page and set latitude and longitude for where you want the geolocation to be. Next, reload a page and check your location.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://mybrowseraddon.com/change-geolocation.html">Website</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/change-geolocation-locati/lejoknkbcogjceoniealiipllomkpioe">Chrome</a></p>
</li>
<li>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/change-geolocation-locguard/">Firefox</a></p>
</li>
</ul>
</li>
</ul>
<h4 id="ub">Universal Bypass</h4>
<blockquote>
<p>Don&rsquo;t waste your time with compliance. Universal Bypass automatically skips annoying link shorteners.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://github.com/Sainan/Universal-Bypass">Source Code</a></p>
</li>
<li>
<p>Chrome:</p>
<ul>
<li>
<p>Download <a href="https://github.com/Sainan/Universal-Bypass/releases/download/13.12.4/Universal.Bypass.for.Chromium-based.browsers.zip">Universal Bypass for Chromium-based browsers.zip</a>.</p>
</li>
<li>
<p>Move this zip file in a convenient folder.</p>
</li>
<li>
<p>Open <code>chrome://extensions</code> in a new tab.</p>
</li>
<li>
<p>Enable &ldquo;Developer mode&rdquo; at the top-right.</p>
</li>
<li>
<p>Drag the zip file from before into the extensions page.</p>
</li>
</ul>
</li>
<li>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/universal-bypass/">Firefox</a></p>
</li>
</ul>
</li>
</ul>
<h4 id="behave">Behave!</h4>
<blockquote>
<p>A (Still in Development) monitoring browser extension for pages acting as bad boys.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://github.com/mindedsecurity/behave">Source Code</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/mppjbkhgconmemoeagfbgilblohhcica/">Chrome</a></p>
</li>
<li>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/behave/">Firefox</a></p>
</li>
</ul>
</li>
</ul>
<h4 id="css">CSS Exfil Protection</h4>
<blockquote>
<p>Guard against CSS data exfiltration attacks.</p>
<p>Guard your browser against CSS Exfil attacks!</p>
<p>CSS Exfil is a method attackers can use to steal data from web pages using Cascading Style Sheets (CSS).  This plugin sanitizes and blocks any CSS rules which may be designed to steal data.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://github.com/mlgualtieri/CSS-Exfil-Protection">Source Code</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/css-exfil-protection/ibeemfhcbbikonfajhamlkdgedmekifo">Chrome</a></p>
</li>
<li>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/css-exfil-protection/">Firefox</a></p>
</li>
</ul>
</li>
<li>
<p><a href="https://www.mike-gualtieri.com/posts/stealing-data-with-css-attack-and-defense">Stealing Data With CSS: Attack and Defense</a></p>
</li>
</ul>
<h4 id="h264ify">h264ify</h4>
<blockquote>
<p>h264ify is a Chrome/Firefox extension that makes YouTube stream H.264 videos instead of VP8/VP9 videos.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://github.com/erkserkserks/h264ify">Source Code</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/h264ify/aleakchihdccplidncghkekgioiakgal">Chrome</a></p>
</li>
</ul>
</li>
</ul>
<h4 id="suspender">The Great Suspender</h4>
<blockquote>
<p>&ldquo;The Great Suspender&rdquo; is a free and open-source Google Chrome extension for people who find that chrome is consuming too much system resource or suffer from frequent chrome crashing. Once installed and enabled, this extension will automatically suspend tabs that have not been used for a while, freeing up memory and cpu that the tab was consuming.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://github.com/greatsuspender/thegreatsuspender">Source Code</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/the-great-suspender/klbibkeccnjlkjkiokjodocebajanakg">Chrome</a></p>
</li>
</ul>
</li>
</ul>
<h4 id="sponsorblock">SponsorBlock</h4>
<blockquote>
<p>SponsorBlock is an extension that will skip over sponsored segments of YouTube videos. SponsorBlock is a crowdsourced browser extension that lets anyone submit the start and end times of sponsored segments of YouTube videos. Once one person submits this information, everyone else with this extension will skip right over the sponsored segment.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://github.com/ajayyy/SponsorBlock">Source Code</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/mnjggcdmjocbbbhaepdhchncahnbgone">Chrome</a></p>
</li>
<li>
<p><a href="https://addons.mozilla.org/addon/sponsorblock/?src=external-github">Firefox</a></p>
</li>
</ul>
</li>
</ul>
<h4 id="redirect">Redirector</h4>
<blockquote>
<p>Redirector is a browser add-on for Firefox, Chrome and Opera. The add-on lets you create redirects for specific webpages, e.g. always redirect <a href="http://bing.com">http://bing.com</a> to <a href="http://google.com">http://google.com</a>. It was originally done by request for someone on the Mozillazine forums. The redirect patterns can be specified using regular expressions or simple wildcards and the resulting url can use substitutions based on captures from the original url.</p>
</blockquote>
<ul>
<li>
<p><em>Links:</em></p>
<ul>
<li>
<p><a href="https://github.com/einaregilsson/Redirector">Source Code</a></p>
</li>
<li>
<p><a href="https://chrome.google.com/webstore/detail/redirector/ocgpenflpmgnfapjedencafcfakcekcd">Chrome</a></p>
</li>
<li>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/5064">Firefox</a></p>
</li>
</ul>
</li>
<li>
<p>To Set redirects</p>
<p><img src="/img/3_10.png" alt="redirects"></p>
</li>
</ul>
<h3 id="flags">Flags</h3>
<ul>
<li>
<p>I have enabled many flags to improve my performance, privacy and security. The flags are only experimental features so be careful and enable/disable under your own risk.</p>
</li>
<li>
<p>To edit the flags, go to <code>brave://flags</code></p>
</li>
</ul>
<h4 id="enabled-flags"><em>Enabled Flags</em></h4>
<ul>
<li>
<p><strong>#enable-webrtc-hide-local-ips-with-mdns</strong> - Conceal local IP addresses with mDNS hostnames.</p>
</li>
<li>
<p><strong>#enable-vulkan</strong> - Use vulkan as the graphics backend.</p>
</li>
<li>
<p><strong>#cookies-without-same-site-must-be-secure</strong> - If enabled, cookies without SameSite restrictions must also be Secure. If a cookie without SameSite restrictions is set without the Secure attribute, it will be rejected. This flag only has an effect if &ldquo;SameSite by default cookies&rdquo; is also enabled.</p>
</li>
<li>
<p><strong>#improved-cookie-controls</strong> - mproved UI in Incognito mode for third-party cookie blocking. – Mac, Windows, Linux, Chrome OS, Android</p>
</li>
<li>
<p><strong>#improved-cookie-controls-for-third-party-cookie-blocking</strong> - Enables an improved UI for existing third-party cookie blocking users.</p>
</li>
<li>
<p><strong>#enable-heavy-ad-intervention</strong> - Heavy Ad Intervention
Unloads ads that use too many device resources.</p>
</li>
<li>
<p><strong>#reduced-referrer-granularity</strong> - If a page hasn&rsquo;t set an explicit referrer policy, setting this flag will reduce the amount of information in the &lsquo;referer&rsquo; header for cross-origin requests.</p>
</li>
<li>
<p><strong>#treat-unsafe-downloads-as-active-content</strong> - Disallows downloads of unsafe files (files that can potentially execute code), where the final download origin or any origin in the redirect chain is insecure if the originating page is secure</p>
</li>
<li>
<p><strong>#enable-removing-all-third-party-cookies</strong> - Enables UI on chrome://settings/siteData to remove all third-party cookies and site data.</p>
</li>
<li>
<p><strong>#prefetch-privacy-changes</strong> - Prefetch requests will not follow redirects, not send a Referer header, not send credentials for cross-origin requests, and do not pass through service workers.</p>
</li>
<li>
<p><strong>#turn-off-streaming-media-caching</strong> - Reduces disk activity during media playback, which can result in power savings.</p>
</li>
<li>
<p><strong>#audio-worklet-realtime-thread</strong> - Run Audio Worklet operation on a realtime priority thread for better audio stream stability.</p>
</li>
<li>
<p><strong>#enable-parallel-downloading</strong> - Enable parallel downloading to accelerate download speed.</p>
</li>
<li>
<p><strong>#privacy-settings-redesign</strong> - Redesign of the privacy settings card to make it more prominent and and easier to use.</p>
</li>
<li>
<p><strong>#show-legacy-tls-warnings</strong> - Show security warnings for sites that use legacy TLS versions (TLS 1.0 and TLS 1.1), which are deprecated and will be removed in the future.</p>
</li>
<li>
<p><strong>#tab-groups</strong> - Allows users to organize tabs into visually distinct groups, e.g. to separate tabs associated with different tasks.</p>
</li>
<li>
<p><strong>#tab-groups-collapse</strong> (if #tab-groups is enabled) - Allows a tab group to be collapsible and expandable, if tab groups are enabled. – Mac, Windows, Linux, Chrome OS</p>
</li>
<li>
<p><strong>#enable-noscript-previews</strong> - Enable disabling JavaScript on some pages on slow networks.</p>
</li>
<li>
<p><strong>#freeze-user-agent</strong> - Set the User-Agent request header to a static string that conforms to the current User-Agent string format but only reveals desktop vs Android and if the &lsquo;mobile&rsquo; flag is set.</p>
</li>
</ul>
<h4 id="disabled-flags"><em>Disabled Flags</em></h4>
<ul>
<li>
<p><strong>#allow-popups-during-page-unload</strong> - When the flag is set to enabled, pages are allowed to show popups while they are being unloaded.</p>
</li>
<li>
<p><strong>#enable-generic-sensor-extra-classes</strong> - Enables an extra set of sensor classes based on Generic Sensor API, which expose previously unavailable platform features, i.e. AmbientLightSensor and Magnetometer interfaces.</p>
</li>
<li>
<p><strong>#tab-hover-cards</strong> - Enables a popup containing tab information to be visible when hovering over a tab. This will replace tooltips for tabs</p>
</li>
<li>
<p><strong>#enable-user-data-snapshot</strong> - Enables taking snapshots of the user data directory after a Chrome update and restoring them after a version rollback</p>
</li>
<li>
<p><strong>#enable-text-fragment-anchor</strong> - Enables scrolling to text specified in URL&rsquo;s fragment.</p>
</li>
<li>
<p><strong>#happiness-tracking-surveys-for-desktop-demo</strong> - Enable showing Happiness Tracking Surveys Demo to users on Desktop.</p>
</li>
<li>
<p><strong>#happiness-tracking-surveys-for-desktop</strong> - Enable showing Happiness Tracking Surveys to users on Desktop.</p>
</li>
<li>
<p><strong>#raw-clipboard</strong> - Allows raw / unsanitized clipboard content to be read and written.</p>
</li>
</ul>
<h2 id="android">My Android Device Browser Configuration</h2>
<p><strong>Details:</strong></p>
<ul>
<li>
<p>Operating System - ArrowOS (ASOP based)</p>
<ul>
<li>
<p><a href="https://arrowos.net/">Website</a></p>
</li>
<li>
<p><a href="https://arrowos.net/download.html">Download</a></p>
</li>
</ul>
</li>
<li>
<p>Browser</p>
<ul>
<li>
<p>Brave</p>
<ul>
<li>
<p><a href="https://brave.com/">Website</a></p>
</li>
<li>
<p><a href="https://play.google.com/store/apps/details?id=com.brave.browser&amp;hl=en">Download</a></p>
</li>
</ul>
</li>
<li>
<p>Bromite</p>
<ul>
<li>
<p><a href="https://www.bromite.org/">Website</a></p>
</li>
<li>
<p><a href="https://github.com/bromite/bromite/releases">Download</a></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Most of all the settings are set to default.</p>
<h3 id="and-ads">AdBlocking and AdFiltering</h3>
<p>I use AdGuard for filtering, blocking the advertisements and trackers. It has many features including a Firewall and HTTPS Filtering.</p>
<ul>
<li>
<p><a href="https://adguard.com/en/welcome.html">Website</a></p>
</li>
<li>
<p><a href="https://adguard.com/en/adguard-android/overview.html">Download</a></p>
</li>
</ul>
<h3 id="and-flags">Flags</h3>
<h4 id="enabled-flags-1"><em>Enabled Flags</em></h4>
<ul>
<li>
<p><strong>#context-menu-copy-image</strong> - Enable copying image to system clipboard via context menu.</p>
</li>
<li>
<p><strong>#smooth-scrolling</strong> - Animate smoothly when scrolling page content.</p>
</li>
<li>
<p><strong>#enable-vulkan</strong> - Use vulkan as the graphics backend.</p>
</li>
<li>
<p><strong>#tls13-hardening-for-local-anchors</strong> - This option enables the TLS 1.3 downgrade hardening mechanism for connections authenticated by local trust anchors. This improves security for connections to TLS-1.3-capable servers while remaining compatible with older servers. Firewalls and proxies that do not function when this is enabled do not implement TLS 1.2 correctly or securely and must be updated.</p>
</li>
<li>
<p><strong>#enable-autofill-credit-card-ablation-experiment</strong> - If enabled, credit card autofill suggestions will not display.</p>
</li>
</ul>
<h4 id="disabled-flags-1"><em>Disabled Flags</em></h4>
<ul>
<li>
<p><strong>#enable-games-hub</strong> - Enables viewing and usage of the Games Hub.</p>
</li>
<li>
<p><strong>#media-history</strong> Enables Media History which records data around media playbacks on websites.</p>
</li>
</ul>
<p>Some flags are set by default to improve the user&rsquo;s experience.</p>
<h2 id="conclusion">Conclusion</h2>
<p>This is my current configuration. I will be updating it, as learn to tweak it more. If you have any suggestions (or) would like to talk about your stuff (or) to just hang out and chat join our <a href="https://discord.gg/JtfPSBf">Discord Server</a>.</p>
]]></content>
        </item>
        
        <item>
            <title>control groups (cgroups) - CPUACCT</title>
            <link>https://theupbeat.github.io/posts/cgroups_2/</link>
            <pubDate>Tue, 23 Jun 2020 18:00:23 +0530</pubDate>
            
            <guid>https://theupbeat.github.io/posts/cgroups_2/</guid>
            <description>As explained in the previous post, control groups are used to limit, prioritize, etc., the available resources in a system. In this series of post we will be creating, limiting, assigning tasks to the cgroups.
 NOTE
In this whole process I will be using a Arch-based machine with Systemd, specifically Manjaro (please don&amp;rsquo;t come after me).
 Part II - Demonstrating libcgroup We can control the cgroups using shell commands.</description>
            <content type="html"><![CDATA[<p>As explained in the previous post, control groups are used to limit, prioritize, etc., the available resources in a system. In this series of post we will be creating, limiting, assigning tasks to the cgroups.</p>
<hr>
<p><strong>NOTE</strong></p>
<p>In this whole process I will be using a Arch-based machine with Systemd, specifically Manjaro (please don&rsquo;t come after me).</p>
<hr>
<h2 id="part-ii---demonstrating">Part II - Demonstrating</h2>
<h3 id="libcgroup">libcgroup</h3>
<p>We can control the cgroups using shell commands. This can be done with the help of <code>libcgroup</code> package. The package provides a lot of features to the user. The features may vary like mounting, editing the values, etc.</p>
<h4 id="installation">Installation</h4>
<p>To install libcgroup in your system, run the appropriate command:</p>
<p>For Arch-based machines:</p>
<pre><code>pacman -S install libcgroup

If you are unable to do so, download the package from aur:

git clone https://aur.archlinux.org/libcgroup.git
cd libcgroup
makepkg -si
</code></pre><p>For Debian-based machines:</p>
<pre><code>apt install libcgroup
</code></pre><p>For Fedora-based machines:</p>
<pre><code>yum install libcgroup
</code></pre><h4 id="available-cgroups">Available cgroups</h4>
<p>To see the available cgroups in your system, use:</p>
<pre><code>lscgroup # This package is installed with libcgroup
</code></pre><p><img src="/img/2_1.png" alt="lscgroup"></p>
<p>cgroups are located at <code>\sys\fs\cgroup\</code>, run the ls command to see the files in the directory:</p>
<pre><code>ls -l \sys\fs\cgroup\
</code></pre><p><img src="/img/2_2.png" alt="ls -l \sys\fs\cgroup"></p>
<h3 id="working-with-cgroups">Working with cgroups</h3>
<p>There are a 12 control groups:</p>
<ul>
<li><code>blkio</code>      - Block I/O (or) set limits to read/write from/to.</li>
<li><code>cpu</code>        - Control CPU time using CFS (Completely Fair Scheduler).</li>
<li><code>cpuacct</code>    - Reports are generated regarding the usage of CPU resources by a process.</li>
<li><code>cpuset</code>     - Assings inividual CPUs and memory nodes to tasks (in a single cgroup).</li>
<li><code>devices</code>    - Allow/Deny access to devices.</li>
<li><code>freezer</code>    - Suspends/Resumes a process.</li>
<li><code>hugetlb</code>    - Allows/Denys the use of huge pages for a specific group.</li>
<li><code>memory</code>     - Set limits on usage for memory for a task/process.</li>
<li><code>net_cls</code>    - Allows to note/mark specific packets from a group.</li>
<li><code>net_prio</code>   - Set the priority dynamically to the network traffic.</li>
<li><code>perf_event</code> - Allows access to a perf events to a group.</li>
<li><code>pids</code>       - To limit the number of process/tasks from being forked for cloned when a certain limit is reached.</li>
</ul>
<p>In this post, we will be looking at cpuacct.</p>
<h4 id="cpuacct">CPUACCT</h4>
<p>The cpuacct (CPU accounting controller) is used to group the tasks that are to be monitored for the usage of CPU.</p>
<p>CPUACCT can support multiple hierarchies. For example, if a group contains two subgroups, the subgroups usage can be monitored by the parent group.</p>
<p>To create CPUACCT groups we need to mount the cgroup filesystem (do this if the cgroup is not already mounted):</p>
<pre><code>mount -t cgroup -o cpuacct none /sys/fs/cgroup
</code></pre><p>This mounts the parent group, can be visible at /sys/fs/cgroup.</p>
<p>You can view all the contents of the cpuacct folder, using ls command:</p>
<pre><code>ls -l /sys/fs/cgroup/cpuacct/
</code></pre><p><img src="/img/2_4.png" alt="ls -l /sys/fs/cgroup/cpuacct"></p>
<p>There are a lot of files in the cpuacct cgroup, we can see that most files starts with the controller name i.e. cpuacct. This is helpful when we combine two controllers like cpuacct and devices, there will be no conflicts between the controllers.</p>
<p>Now we will look at the tasks file which contains the PIDs that are attached to the cgroup. When booted all the tasks are entered into <code>/sys/fs/cgroup/cpuacct/tasks</code>. We can view it using the cat command:</p>
<pre><code>cat /sys/fs/cgroup/cpuacct/tasks
</code></pre><p><img src="/img/2_3.png" alt="cat /sys/fs/cgroup/cpuacct/tasks"></p>
<p>There are different files like cpuacct.usage, cpuacct.stat, etc. present in the directory.</p>
<p>The cpuacct.usage is used to see the consumed CPU time (presented in nanoseconds):</p>
<pre><code>cat /sys/fs/cgroup/cpuacct/cpuacct.usage
</code></pre><p><img src="/img/2_5.png" alt="cat /sys/fs/cgroup/cpuacct/cpuacct.usage"></p>
<p>The cpuacct.stat is used to see the consumed user and system CPU time by all the tasks included in the cgroup, this also includes the tasks in the lower hierarchy. It is presented as:</p>
<ul>
<li><code>user</code> - CPU time consumed by tasks in user mode.</li>
<li><code>system</code> - CPU time consumed by tasks in system (kernel) mode.</li>
</ul>
<p>To see the content of the file use the cat command:</p>
<pre><code>cat /sys/fs/cgroup/cpuacct/cpuacct.stat
</code></pre><p><img src="/img/2_6.png" alt="cat /sys/fs/cgroup/cpuacct/cpuacct.stat"></p>
<h4 id="creating-new-groups-under-cpuacct">Creating New Groups under CPUACCT</h4>
<p>The new groups should be created under <code>/sys/fs/cgroup/cpuacct</code>.</p>
<pre><code>cd /sys/fs/cgroup/cpuacct
mkdir test1
cd test1
</code></pre><p><code>ls -l</code> to see the files created in the test directory:</p>
<p><img src="/img/2_7.png" alt="ls -1"></p>
<p>You can see the files the are in the parent group are also created in the child group.</p>
<p>I would like to monitor the CPU usage of the current bash shell. To do that echo the PID of the shell in to the <code>tasks</code> file.</p>
<pre><code>echo $$ &gt; tasks

cat tasks # To see the PID of the bash
</code></pre><p><img src="/img/2_8.png" alt="tasks file"></p>
<p>To see the CPU time consumed by the bash shell, see the <code>cpuacct.usage</code>.</p>
<p><img src="/img/2_9.png" alt="cat cpuacct.usage"></p>
<p>To see the CPU time consumed by user and system modes, see the <code>cpuacct.stat</code>.</p>
<p><img src="/img/2_10.png" alt="cat cpuacct.stat"></p>
<p>The values of user and system in the stat file are in USER_HZ units.</p>
<p>There are <code>percpu</code> and <code>peruser</code> files which shows you the CPU time consumed by a single cpu (for multi-cored cpus) and CPU time consumed by a single user (if there are different users attached to the cgroup) respectively.</p>
<p>You can attach as many processes as you want, just echo the PID into the tasks file.</p>
<h4 id="persistent-group-configuration">Persistent group configuration</h4>
<p>The newly created cgroups will be deleted after a reboot. To have the cgroups maintained even after a reboot we need to make persistent group configuration by editing the <code>/etc/cgconfig.conf</code> file.</p>
<p>Syntax for creating a cgroup and adding controllers:</p>
<pre><code>group &lt;groupname&gt; {
  perm {
# who can manage limits
    admin {
      uid = $USER;
      gid = $GROUP;
    }
# who can add tasks to this group
    task {
      uid = $USER;
      gid = $GROUP;
    }
  }
# create this group in cpu and memory controllers
  &lt;controller { }&gt;
  cpu { }
  memory { }
}
</code></pre><p>where,</p>
<ul>
<li><code>groupname</code>  - The name of the group.</li>
<li><code>perm</code>       - Permissions (optional). This is added for controlling the rights of the group.</li>
<li><code>Controller</code> - To which controller will the group be created in (in our case the controller is cpuacct).</li>
</ul>
<p>For example, I created a persistent group configuration for cpuacct:</p>
<pre><code class="language-group" data-lang="group">  perm {
    admin {
      uid = theupbeat;
      gid = theupbeat;
    }
    task {
      uid = theupbeat;
      gid = theupbeat;
    }
  }
  cpuacct { }
}
</code></pre><h3 id="resources">Resources</h3>
<ol>
<li><a href="https://wiki.archlinux.org/index.php/cgroups">https://wiki.archlinux.org/index.php/cgroups</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/resource_management_guide/ch-using_control_groups">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/resource_management_guide/ch-using_control_groups</a></li>
<li><a href="https://www.kernel.org/doc/Documentation/cgroup-v1/cpuacct.txt">https://www.kernel.org/doc/Documentation/cgroup-v1/cpuacct.txt</a></li>
<li><a href="https://sysadmincasts.com/episodes/14-introduction-to-linux-control-groups-cgroups">https://sysadmincasts.com/episodes/14-introduction-to-linux-control-groups-cgroups</a></li>
<li><a href="https://manpages.ubuntu.com/manpages/xenial/man5/cgconfig.conf.5.html">https://manpages.ubuntu.com/manpages/xenial/man5/cgconfig.conf.5.html</a></li>
</ol>
]]></content>
        </item>
        
        <item>
            <title>control groups (cgroups) - Introduction</title>
            <link>https://theupbeat.github.io/posts/cgroups_1/</link>
            <pubDate>Wed, 17 Jun 2020 10:30:00 +0530</pubDate>
            
            <guid>https://theupbeat.github.io/posts/cgroups_1/</guid>
            <description>The Linux Kernel is full of mysteries and tools which can help boost the performance, improve the efficiency and at the same time break the system. This series mainly focuses on the &amp;ldquo;cgroups&amp;rdquo; feature in the Linux Kernel. There will be a series of posts explaining, demonstrating, and tweaking it.
Part I - Introduction What is cgroups cgroups is a feature available to the end user which is present in Linux Kernel.</description>
            <content type="html"><![CDATA[<p>The Linux Kernel is full of mysteries and tools which can help boost the performance, improve the efficiency and at the same time break the system. This series mainly focuses on the &ldquo;<strong>cgroups</strong>&rdquo; feature in the Linux Kernel. There will be a series of posts explaining, demonstrating, and tweaking it.</p>
<h2 id="part-i---introduction">Part I - Introduction</h2>
<h3 id="what-is-cgroups">What is cgroups</h3>
<p><strong>cgroups</strong> is a feature available to the end user which is present in Linux Kernel. It can be used in limiting, prioritizing, accounting and controlling the resources to a specific group of processes/tasks.</p>
<p>A resource may be CPU time, Memory, Network bandwidth, etc. For example, if a browser (or) any application uses more than 25% of the memory, it can be limited to use not more than 15% with the help of cgroups.</p>
<p>As the name says, it is a group of processes aggregated/partitioned. The cgroups is organised hierarchically, which makes the child inherit the parent&rsquo;s limits/configuration.</p>
<h3 id="the-model">The Model</h3>
<p>The hierarchy is implemented everywhere in the Linux Kernel. The hierarchy is set of cgroups arranged in tree. Take <strong>init process</strong>, it is the first thing that starts after the boot, this makes it the parent of all the other processes. The Linux Model is a single hierarchy/tree.</p>
<p>Whereas the cgroup model can have different groups of hierarchies, making it an unconnected trees of tasks. Multiple hierarchy means that for each subsystem there exist a cgroup model.</p>
<h3 id="development">Development</h3>
<p>It seems weird and interesting that the idea of cgroups was first coined by Google, mainly the Devs - Paul Menage and Rohit Seth. It was first implemented in the year of 2006 and named as &ldquo;<a href="https://lwn.net/Articles/236038/">Process Containers</a>&rdquo;. Later on the it has been to changed to &ldquo;control groups&rdquo; due to the name having containers which caused a lot of confusions.</p>
<p>The control groups were first implemented in Linux Kernel version 2.6.24 (released in 2008). Continuing from there on, the developers have been adding features and supporting it till date. The features include kernfs, unified hierarchy, firewalling, etc.</p>
<p>Overall there were two versions of cgroups. The <a href="https://man7.org/linux/man-pages/man7/cgroups.7.html#CGROUPS_VERSION_1">v1</a> which was developed by the devs from google and the <a href="https://man7.org/linux/man-pages/man7/cgroups.7.html#CGROUPS_VERSION_2">v2</a> was developed by Tejun Heo after acquiring it. The v2 was first implemented in Linux Kernel version 4.5 (released in 2016).</p>
<h3 id="why-do-we-need-it">Why do we need it?</h3>
<p>There were many attempts to create a system that can help in tracking the resources. But they lack in grouping/partitioning of processes which lead to forking or creating child processes in the same group as their parent.</p>
<p>The cgroups provide the required mechanisms to implement this efficiently. cgroups has also provided multiple hierarchy support, which would help in dividing different tasks for different subsystems. This enables parallel hierarchy that helps in handling complex combinations of processes, without which would to lead to combinations of tasks in the same cgroup.</p>
<h4 id="example-taken-from-5httpswwwkernelorgdocdocumentationcgroup-v1cgroupstxt">Example (Taken from <a href="https://www.kernel.org/doc/Documentation/cgroup-v1/cgroups.txt">5</a>)</h4>
<p><img src="/img/1.png" alt="example"></p>
<p>Consider the above hierarchy which illustrate the use of multiple hierarchy in a university where various users like professors, students and system use the same server. The usage is divided in the following way</p>
<p>Memory:</p>
<ul>
<li>Professors - 45%</li>
<li>Students - 30%</li>
<li>System - 25%</li>
</ul>
<p>Disk:</p>
<ul>
<li>Professors - 45%</li>
<li>Students - 30%</li>
<li>System - 25%</li>
</ul>
<p>Network:</p>
<ul>
<li>WWW Browsing - 25%</li>
<li>Network File System - 55%</li>
<li>Others - 20%</li>
</ul>
<p>When we use multiple hierarchy, the tasks can be classified differently for different resources, like allocating resource subsystems into different hierarchies, we can easily modify the system to work differently depending on who is using.</p>
<p>When we only use a single hierarchy, the admin needs to create a separate cgroup for every specific application used and needs to allocate the resources. Single hierarchy also makes it hard to provide enhanced privileges to a user.</p>
<h3 id="alternative">Alternative</h3>
<p>There are three different system calls that can be used to limit the resources to a specific process/tasks.</p>
<ul>
<li><code>getrlimit</code></li>
<li><code>setrlimit</code></li>
<li><code>prlimit</code></li>
</ul>
<p>Calls to the <code>getrlimit</code> and <code>setrlimit</code> system allow a process to read and set limitations on the system resources it may consume. The <code>prlimit</code> allows the resource limits of a process specified by PID to be set and read.</p>
<p>For more understanding and usage, check the man pages:</p>
<ul>
<li><a href="https://man7.org/linux/man-pages/man2/getrlimit.2.html">getrlimit</a></li>
<li><a href="https://linux.die.net/man/2/setrlimit">setrlimit</a></li>
<li><a href="https://www.man7.org/linux/man-pages/man1/prlimit.1.html">prlimit</a></li>
</ul>
<h3 id="different-cgroups">Different cgroups</h3>
<p>There are 12 different types of cgroups in Linux:</p>
<ul>
<li><code>blkio</code> - Block I/O (or) set limits to read/write from/to.</li>
<li><code>cpu</code> - Control CPU time using CFS (Completely Fair Scheduler).</li>
<li><code>cpuacct</code> - Reports are generated regarding the usage of CPU resources by a process.</li>
<li><code>cpuset</code> - Assings inividual CPUs and memory nodes to tasks (in a single cgroup).</li>
<li><code>devices</code> - Allow/Deny access to devices.</li>
<li><code>freezer</code> - Suspends/Resumes a process.</li>
<li><code>hugetlb</code> - Allows/Denys the use of huge pages for a specific group.</li>
<li><code>memory</code> - Set limits on usage for memory for a task/process.</li>
<li><code>net_cls</code> - Allows to note/mark specific packets from a group.</li>
<li><code>net_prio</code> - Set the priority dynamically to the network traffic.</li>
<li><code>perf_event</code> - Allows access to a perf events to a group.</li>
<li><code>pids</code> -  To limit the number of process/tasks from being forked for cloned when a certain limit is reached.</li>
</ul>
<h3 id="enabled-cgroups">Enabled cgroups</h3>
<p>To see the what/which cgroups are present in your system:</p>
<pre><code>cat /proc/cgroups
</code></pre><p><img src="/img/2.png" alt="cat /proc/cgroups"></p>
<!-- raw HTML omitted -->
<p>You can also see via sysfs:</p>
<pre><code>ls -l /sys/fs/cgroup/
</code></pre><p><img src="/img/3.png" alt="ls -l /sys/fs/cgroup/"></p>
<p>To get cgroups for a specific PID, we can use <strong>cat /proc/[PID]/cgroup/</strong>.</p>
<p>To get the PIDs use:</p>
<pre><code>ps -d
</code></pre><p><img src="/img/4.png" alt="ps -d"></p>
<p>I will be showing the cgroups of the ZSH shell (PID: 72980)</p>
<pre><code>cat /proc/72980/cgroup
</code></pre><p><img src="/img/5.png" alt="cat /proc/72980/cgroup"></p>
<h3 id="continued">Continued</h3>
<p>This is a series that explains the cgroups. The following posts will be demonstrating and tweaking the cgroups.</p>
<h3 id="resources">Resources</h3>
<ol>
<li><a href="https://en.wikipedia.org/wiki/Cgroups#cite_ref-4">https://en.wikipedia.org/wiki/Cgroups#cite_ref-4</a></li>
<li><a href="https://wiki.archlinux.org/index.php/cgroups">https://wiki.archlinux.org/index.php/cgroups</a></li>
<li><a href="https://www.grant.pizza/blog/understanding-cgroups/#practically-using-cgroups">https://www.grant.pizza/blog/understanding-cgroups/#practically-using-cgroups</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/performance_tuning_guide/chap-red_hat_enterprise_linux-performance_tuning_guide-overview">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/performance_tuning_guide/chap-red_hat_enterprise_linux-performance_tuning_guide-overview</a></li>
<li><a href="https://www.kernel.org/doc/Documentation/cgroup-v1/cgroups.txt">https://www.kernel.org/doc/Documentation/cgroup-v1/cgroups.txt</a></li>
<li><a href="https://www.kernel.org/doc/Documentation/cgroup-v1/">https://www.kernel.org/doc/Documentation/cgroup-v1/</a></li>
<li><a href="https://www.kernel.org/doc/Documentation/cgroup-v2.txt">https://www.kernel.org/doc/Documentation/cgroup-v2.txt</a></li>
<li><a href="https://man7.org/linux/man-pages/man7/cgroups.7.html#CGROUPS_VERSION_1">https://man7.org/linux/man-pages/man7/cgroups.7.html#CGROUPS_VERSION_1</a></li>
<li><a href="https://man7.org/linux/man-pages/man7/cgroups.7.html#CGROUPS_VERSION_2">https://man7.org/linux/man-pages/man7/cgroups.7.html#CGROUPS_VERSION_2</a></li>
<li><a href="https://0xax.gitbooks.io/linux-insides/content/Cgroups/linux-cgroups-1.html">https://0xax.gitbooks.io/linux-insides/content/Cgroups/linux-cgroups-1.html</a></li>
</ol>
]]></content>
        </item>
        
    </channel>
</rss>
